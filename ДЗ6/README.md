### ЗАДАНИЕ
![image](https://github.com/user-attachments/assets/ff2ada9f-c60c-46b0-99b7-16272773fcc2)
### используемые инструменты 
```
скрипт генерации нагрузки
psql -U postgres -c  "
create table test as
select generate_series as id
	, generate_series::text || (random() * 10)::text as col2
    , (array['Yes', 'No', 'Maybe'])[floor(random() * 3 + 1)] as is_okay
from generate_series(1, 500000);update test  set  is_okay  = 'NeverNever' where id%2  = 0 ;drop table test;"

скрипт получения информации об объеме wal-файлов сгенерированных скриптом
psql -U postgres -c  "select pg_current_wal_lsn();"
0/4C2ED4B8
psql -U postgres -c  "select pg_size_pretty(pg_wal_lsn_diff(pg_current_wal_lsn(),'0/4C2ED4B8'));"

изменяемые параметры
wal_level  minimal -> replica - > logical
max_wal_senders 0 -> 2
full_page_writes off -> on
wal_compression  off -> on
min_wal_size  50MB -> 3GB
max_wal_size  50MB -> 3GB
checkpoint  1min -> 10 min
```
### результаты изменения настройки WAL 
| wal_level | minimal | replica+full_page_writes| logical+full_page_writes|logical + compression |
| --- | --- |--- |--- |--- |
| wal size | 12 kB | 85 MB | 85 MB | 85 MB |

### результаты изменения настройки checkpoint
```
max_wal_size  50MB   checkpoint  1min 
2025-06-20 15:25:54.166 MSK [2797] СООБЩЕНИЕ:  начата контрольная точка: wal
2025-06-20 15:25:55.405 MSK [2797] СООБЩЕНИЕ:  контрольная точка завершена: записано буферов: 1517 (1.2%); добавлено файлов WAL 0, удалено: 0, переработано: 1; запись=0.964 сек., синхр.=0.056 сек., всего=1.239 сек.; синхронизировано_файлов=2, самая_долгая_синхр.=0.052 сек., средняя=0.028 сек.; расстояние=15274 kB, ожидалось=19522 kB; lsn=1/A1543A0, lsn redo=1/91C11E8
2025-06-20 15:25:55.405 MSK [2797] СООБЩЕНИЕ:  контрольные точки происходят слишком часто (через 1 сек.)
2025-06-20 15:25:55.405 MSK [2797] ПОДСКАЗКА:  Возможно, стоит увеличить параметр "max_wal_size".

2025-06-20 15:26:01.885 MSK [2797] СООБЩЕНИЕ:  выключение
2025-06-20 15:26:01.981 MSK [2797] СООБЩЕНИЕ:  контрольная точка завершена: записано буферов: 6 (0.0%); добавлено файлов WAL 0, удалено: 0, переработано: 0; 
запись=0.018 сек., синхр.=0.023 сек., всего=0.096 сек.; синхронизировано_файлов=6, самая_долгая_синхр.=0.008 сек., средняя=0.004 сек.; расстояние=788 kB, ожидалось=16838 kB; lsn=1/C1FB4B8, lsn redo=1/C1FB4B8
2025-06-20 15:26:02.694 MSK [2814] СООБЩЕНИЕ:  система БД готова принимать подключения

max_wal_size  3MB   checkpoint  10min 
2025-06-20 15:29:15.593 MSK [2861] СООБЩЕНИЕ:  выключение
2025-06-20 15:29:16.166 MSK [2861] СООБЩЕНИЕ:  контрольная точка завершена: записано буферов: 21 (0.0%); добавлено файлов WAL 0, удалено: 0, переработано: 53; 
запись=0.047 сек., синхр.=0.043 сек., всего=0.573 сек.; синхронизировано_файлов=22, самая_долгая_синхр.=0.010 сек., средняя=0.002 сек.; расстояние=877678 kB, ожидалось=877678 kB; lsn=1/41B17C00, lsn redo=1/41B17C00
2025-06-20 15:29:16.981 MSK [2935] СООБЩЕНИЕ:  система БД готова принимать подключения
```
### выводы
при повышении уровня логирования wal_level увеличивается количество информации в wal файлах
при увеличении времени срабатывания чекпойнтов восстановление кластера из журналов идёт дольше

